# ============================================================================
# LANONASIS INFRASTRUCTURE ARCHITECTURE (Updated: 2025-10-27)
# ============================================================================
# This configuration reflects the current microservices architecture:
#
# DOMAIN STRUCTURE:
# - api.lanonasis.com      → Memory services + Netlify Functions (Proxies /v1/auth/* to VPS)
# - auth.lanonasis.com     → Standalone Auth Gateway on VPS (Port 4000)
# - mcp.lanonasis.com      → MCP Protocol services
# - dashboard.lanonasis.com → Frontend dashboard
#
# AUTHENTICATION FLOW (IMPORTANT):
# 1. Frontend/CLI calls: api.lanonasis.com/v1/auth/*
# 2. Netlify _redirects proxies → auth.lanonasis.com/v1/auth/*
# 3. VPS Auth Gateway (PM2) validates via Supabase Auth API
# 4. Sessions stored in Neon Database (auth_gateway schema)
# 5. Returns JWT token
#
# WHY THIS ARCHITECTURE?
# - api.lanonasis.com auth was failing (old implementation)
# - auth.lanonasis.com is a NEW standalone gateway (working!)
# - Netlify proxy maintains backward compatibility with existing clients
# - Neon Database manages all session/audit data (Supabase only validates credentials)
# ============================================================================

# Supabase Configuration (Used by Auth Gateway for credential validation only)
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your-anon-key

# Authentication Configuration
# NOTE: Frontend should use auth.lanonasis.com directly for best performance
# CLI can use api.lanonasis.com (automatically proxied to auth gateway)
VITE_AUTH_DOMAIN=auth.lanonasis.com
VITE_AUTH_BASE_URL=https://auth.lanonasis.com
VITE_AUTH_REDIRECT_URI=https://auth.lanonasis.com/auth/callback
VITE_AUTH_CLIENT_ID=lanonasis-api-dashboard

# API Configuration
# Memory services and other APIs remain on api.lanonasis.com
VITE_API_BASE_URL=https://api.lanonasis.com
VITE_MCP_SERVER_URL=https://mcp.lanonasis.com

# Application Configuration
VITE_APP_NAME=Lanonasis API Dashboard
VITE_APP_VERSION=1.0.0

# Feature Flags
VITE_ENABLE_OAUTH=true
VITE_ENABLE_MCP=true
VITE_ENABLE_ANALYTICS=false

# JWT Configuration (Managed by Auth Gateway)
VITE_JWT_SECRET=your-jwt-secret-key-replace-in-production
VITE_JWT_EXPIRY=7d

# ============================================================================
# DEPLOYMENT NOTES:
# ============================================================================
# 1. Auth Gateway runs on VPS at /opt/lanonasis/onasis-core/services/auth-gateway
# 2. PM2 manages the process (ecosystem.config.cjs)
# 3. Netlify Functions handle Memory services at api.lanonasis.com
# 4. Netlify _redirects proxy /v1/auth/* to VPS auth gateway
# 5. All auth sessions stored in Neon Database (not Supabase database)
# ============================================================================